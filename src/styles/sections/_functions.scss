.s-functions {
  background: $primary-bg;

  &__inner {
    padding: 98px 0 128px;
    position: relative;
    overflow: hidden;
  }

  &__title {
    max-width: 531px;
    width: 100%;
  }

  &__title-prompt {
    margin-bottom: 56px;
  }

  &__items {
    display: flex;
    flex-direction: column;
    max-height: 1401px;
    overflow: hidden;
    gap: 64px;
    transition: all 1s ease-in;

    .capabilities-card:nth-child(4) {
      width: 100%;
      position: absolute;
      top: 100%;
      transform: translateY(-50%);
      pointer-events: none;
      opacity: 0.3;

      .capabilities-card__title-mobile {
        display: none;
      }
    }

    &--opened {
      max-height: 10000px;

      .capabilities-card {
        display: block;
      }

      .capabilities-card:nth-child(4) {
        position: static;
        transform: translateY(0);
        pointer-events: all;
        opacity: 1;
      }

      & + .s-functions__button {
        margin-top: 0;
      }
    }
  }

  &__prompt {
    &:before {
      width: 268px;
    }
  }

  &__button {
    text-align: center;
    margin-top: 48px;
  }
}

@include mq(xl) {
  .s-functions {
    &__title {
      max-width: 400px;
    }
  }
}

@include mq(md) {
  .s-functions {

    &__title-prompt {
      flex-direction: column;
      gap: 20px;
      margin-bottom: 40px;
    }

    .capabilities-card + .capabilities-card {
      margin-top: 40px;
    }


    &__items {
      max-height: 2005px;

      .capabilities-card:nth-child(4) {
        margin-top: 0;
      }

      &--opened {
        .capabilities-card:nth-child(4) {
          margin-top: 40px;
        }
      }
    }

    &__title {
      text-align: center;
    }

    .prompt {
      transform: none;

      &:before {
        display: none;
      }
    }

    &__inner {
      padding: 56px 0 72px;
    }

    &__items {
      gap: 0;
    }

    &__items {
      .capabilities-card:nth-child(4) {
        top: 103%;
        left: 50%;
        transform: translate(-50%, -50%);
        pointer-events: none;
        opacity: 0.3;
      }

      &--opened {
        .capabilities-card:nth-child(4) {
          position: static;
          transform: translate(0);
          pointer-events: all;
          opacity: 1;

          .capabilities-card__title-mobile {
            display: block;
          }
        }
      }
    }

    &__button {
      position: relative;
      z-index: 1;
    }

    &__toggle {
      max-width: 311px;
      width: 100%;
      background: $white;
      box-shadow: 0 4px 30px rgba(85, 118, 157, 0.15);
      border-radius: 32px;
      color: $primary;

      justify-content: center;
      border: none;
    }

  }
}

@include mq(xs) {
  .s-functions {
    &__wrapper-outer {
      background-image: none !important;
    }

    &__items {
      height: 1811px;
    }

    .capabilities-card {
      &__details {
        max-width: 343px;
      }
    }

    .capabilities-card:nth-child(4) {
      top: 105%;
    }
  }
}
